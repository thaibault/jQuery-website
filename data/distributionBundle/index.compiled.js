'use strict';
(function(a,b){'object'==typeof exports&&'object'==typeof module?module.exports=b(require('clientnode'),require('internationalisation'),require('$.fn.scrollTo'),require('$.fn.spin')):'function'==typeof define&&define.amd?define('website-utilities',['clientnode','internationalisation','$.fn.scrollTo','$.fn.spin'],b):'object'==typeof exports?exports['website-utilities']=b(require('clientnode'),require('internationalisation'),require('$.fn.scrollTo'),require('$.fn.spin')):a['website-utilities']=b(a.clientnode,a.internationalisation,a['$.fn.scrollTo'],a['$.fn.spin'])})(this,function(a,b,c,d){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=0)}([function(a,b,c){c(1),a.exports=c(2)},function(){},function(a,b,c){'use strict';function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d('next',a)},function(a){d('throw',a)})}return d('next')})}}function f(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function g(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function h(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(b,'__esModule',{value:!0}),b.Website=b.$=void 0;var i=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(e===void 0){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if('value'in e)return e.value;var g=e.get;return void 0===g?void 0:g.call(d)},k=c(3),l=c(4),m=function(a){return a&&a.__esModule?a:{default:a}}(l);c(5),c(6);var n=b.$=k.$,o=b.Website=function(a){function b(){return f(this,b),g(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return h(b,a),i(b,[{key:'initialize',value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{activateLanguageSupport:!0,additionalPageLoadingTimeInMilliseconds:0,domain:'auto',domNode:{mediaQueryIndicator:'<div class="media-query-indicator">',top:'header',scrollToTopButton:'a[href="#top"]',startUpAnimationClassPrefix:'.website-start-up-animation-number-',windowLoadingCover:'.website-window-loading-cover',windowLoadingSpinner:'.website-window-loading-cover > div'},domNodeSelectorPrefix:'body.{1}',knownScrollEventNames:'scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove',language:{},mediaQueryClassNameIndicator:[['extraSmall','xs'],['small','sm'],['medium','md'],['large','lg']],onViewportMovesToTop:b.noop,onViewportMovesAwayFromTop:b.noop,onChangeToLargeMode:b.noop,onChangeToMediumMode:b.noop,onChangeToSmallMode:b.noop,onChangeToExtraSmallMode:b.noop,onChangeMediaQueryMode:b.noop,onSwitchSection:b.noop,onStartUpAnimationComplete:b.noop,startUpAnimationElementDelayInMiliseconds:100,startUpShowAnimation:[{opacity:1},{}],startUpHide:{opacity:0},switchToManualScrollingIndicator:function(a){return 0<a.which||'mousedown'===a.type||'mousewheel'===a.type||'touchmove'===a.type},scrollToTop:{inLinearTime:!1,options:{duration:'normal'},button:{slideDistanceInPixel:30,showAnimation:{duration:'normal'},hideAnimation:{duration:'normal'}}},trackingCode:null,windowLoadingCoverHideAnimation:[{opacity:0},{}],windowLoadingSpinner:{lines:9,length:23,width:11,radius:40,corners:1,rotate:75,color:'#000',speed:1.1,trail:58,shadow:!1,hwaccel:!1,className:'spinner',zIndex:2e9,top:'auto',left:'auto'},windowLoadedTimeoutAfterDocumentLoadedInMilliseconds:2e3},d=2<arguments.length&&void 0!==arguments[2]&&arguments[2],e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,f=4<arguments.length&&void 0!==arguments[4]&&arguments[4],g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:'',h=this,i=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,k=7<arguments.length&&void 0!==arguments[7]?arguments[7]:{initial:'\n                (function(i,s,o,g,r,a,m){i[\'GoogleAnalyticsObject\']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new window.Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,\'script\',\'//www.google-analytics.com/analytics.js\',\'ga\');window.ga(\'create\', \'{1}\', \'{2}\');\n                window.ga(\'set\', \'anonymizeIp\', true);\n                window.ga(\'send\', \'pageview\', {page: \'{3}\'});\n            ',sectionSwitch:'window.ga(\'send\', \'pageview\', {page: \'{1}\'});',event:'window.ga(\n                \'send\', \'event\', eventCategory, eventAction, eventLabel,\n                eventValue, eventData);\n            '};return this._parentOptions=c,this.startUpAnimationIsComplete=d,this.viewportIsOnTop=f,this.currentMediaQueryMode=g,this.languageHandler=i,this._analyticsCode=k,e?this.currentSectionName=e:'location'in n.global&&n.global.location.hash?this.currentSectionName=n.global.location.hash.substring(1):this.currenSectionName='home',this._onViewportMovesToTop=this.constructor.debounce(this._onViewportMovesToTop.bind(this)),this._onViewportMovesAwayFromTop=this.constructor.debounce(this._onViewportMovesAwayFromTop.bind(this)),this._options=this.constructor.extendObject(!0,{},this._parentOptions,this._options),j(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'initialize',this).call(this,a),this.$domNodes=this.grabDomNode(this._options.domNode),this.disableScrolling(),new Promise(function(a){if(h._options.windowLoadingCoverHideAnimation[1].always=function(){h._handleStartUpEffects(),a(h)},h.$domNodes.windowLoadingSpinner.length&&h.$domNodes.windowLoadingSpinner.spin(h._options.windowLoadingSpinner),h._bindScrollEvents().$domNodes.parent.show(),'window'in h.$domNodes){var b=function(){h.windowLoaded||(h.windowLoaded=!0,h._removeLoadingCover())};n(function(){return h.constructor.timeout(b,h._options.windowLoadedTimeoutAfterDocumentLoadedInMilliseconds)}),h.on(h.$domNodes.window,'load',b)}h._addNavigationEvents()._addMediaQueryChangeEvents()._triggerWindowResizeEvents()._handleAnalyticsInitialisation(),h._options.language.logging||(h._options.language.logging=h._options.logging),h._options.activateLanguageSupport&&!h.languageHandler&&n.Language(h._options.language).then(function(a){h.languageHandler=a})})}},{key:'scrollToTop',value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:b.noop;if(!('document'in n.global))return this;if(this._options.scrollToTop.options.onAfter=a,Object.defineProperty(n.global.document,'body',{value:n('body')[0]}),this._options.scrollToTop.inLinearTime){var c=this.$domNodes.window.scrollTop();this._options.scrollToTop.options.duration=c/4,this.$domNodes.window.scrollTo({top:'-='+c,left:'+=0'},this._options.scrollToTop.options)}else this.$domNodes.window.scrollTo({top:0,left:0},this._options.scrollToTop.options);return this}},{key:'disableScrolling',value:function(){return this.$domNodes.parent.addClass('disable-scrolling').on('touchmove',function(a){return a.preventDefault()}),this}},{key:'enableScrolling',value:function(){return this.off(this.$domNodes.parent.removeClass('disable-scrolling','touchmove')),this}},{key:'triggerAnalyticsEvent',value:function(){if(this._options.trackingCode&&'location'in n.global&&'localhost'!==n.global.location.hostname){this.debug('Run analytics code: "#{this._analyticsCode.event}" with arguments:');for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.debug(b);try{var d;(d=new Function('eventCategory','eventAction','eventLabel','eventData','eventValue',this._analyticsCode.event)).call.apply(d,[this].concat(b))}catch(a){this.warn('Problem in google analytics event code snippet: {1}',a)}}return this}},{key:'_onViewportMovesToTop',value:function(){var a=this;return'hidden'===this.$domNodes.scrollToTopButton.css('visibility')?this.$domNodes.scrollToTopButton.css('opacity',0):(this._options.scrollToTop.button.hideAnimation.always=function(){return a.$domNodes.scrollToTopButton.css({bottom:'-='+a._options.scrollToTop.button.slideDistanceInPixel,display:'none'})},this.$domNodes.scrollToTopButton.finish().animate({bottom:'+='+this._options.scrollToTop.button.slideDistanceInPixel,opacity:0},this._options.scrollToTop.button.hideAnimation)),this}},{key:'_onViewportMovesAwayFromTop',value:function(){return'hidden'===this.$domNodes.scrollToTopButton.css('visibility')?this.$domNodes.scrollToTopButton.css('opacity',1):this.$domNodes.scrollToTopButton.finish().css({bottom:'+='+this._options.scrollToTop.button.slideDistanceInPixel,display:'block',opacity:0}).animate({bottom:'-='+this._options.scrollToTop.button.slideDistanceInPixel,queue:!1,opacity:1},this._options.scrollToTop.button.showAnimation),this}},{key:'_onChangeMediaQueryMode',value:function(){return this}},{key:'_onChangeToLargeMode',value:function(){return this}},{key:'_onChangeToMediumMode',value:function(){return this}},{key:'_onChangeToSmallMode',value:function(){return this}},{key:'_onChangeToExtraSmallMode',value:function(){return this}},{key:'_onSwitchSection',value:function(a){if(this._options.trackingCode&&'__none__'!==this._options.trackingCode&&'location'in n.global&&'localhost'!==n.global.location.hostname&&this.currentSectionName!==a){this.currentSectionName=a,this.debug('Run analytics code: "'+this._analyticsCode.sectionSwitch+'"',this.currentSectionName);try{new Function(this.constructor.stringFormat(this._analyticsCode.sectionSwitch,this.currentSectionName))()}catch(a){this.warn('Problem in analytics section switch code snippet: {1}',a)}}return this}},{key:'_onStartUpAnimationComplete',value:function(){return this.startUpAnimationIsComplete=!0,this}},{key:'_addMediaQueryChangeEvents',value:function(){return this.on(this.$domNodes.window,'resize',this._triggerWindowResizeEvents.bind(this)),this}},{key:'_triggerWindowResizeEvents',value:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];var d,e=!0,f=!1;try{for(var g,h,i=this._options.mediaQueryClassNameIndicator[Symbol.iterator]();!(e=(g=i.next()).done);e=!0)h=g.value,this.$domNodes.mediaQueryIndicator.prependTo(this.$domNodes.parent).addClass('hidden-'+h[1]),this.$domNodes.mediaQueryIndicator.is(':hidden')&&h[0]!==this.currentMediaQueryMode&&(this.fireEvent.apply(this,['changeMediaQueryMode',!1,this,this.currentMediaQueryMode,h[0]].concat(b)),this.fireEvent.apply(this,[this.constructor.stringFormat('changeTo{1}Mode',this.constructor.stringCapitalize(h[0])),!1,this,this.currentMediaQueryMode,h[0]].concat(b)),this.currentMediaQueryMode=h[0]),this.$domNodes.mediaQueryIndicator.removeClass('hidden-'+h[1])}catch(a){f=!0,d=a}finally{try{!e&&i.return&&i.return()}finally{if(f)throw d}}return this}},{key:'_bindScrollEvents',value:function(){for(var a=this,b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];if(!('window'in this.$domNodes))return this;var e=n('body, html').add(this.$domNodes.window);return e.on(this._options.knownScrollEventNames,function(b){a._options.switchToManualScrollingIndicator(b)&&e.stop(!0)}),this.on(this.$domNodes.window,'scroll',function(){a.$domNodes.window.scrollTop()?a.viewportIsOnTop&&(a.viewportIsOnTop=!1,a.fireEvent.apply(a,['viewportMovesAwayFromTop',!1,a].concat(c))):!a.viewportIsOnTop&&(a.viewportIsOnTop=!0,a.fireEvent.apply(a,['viewportMovesToTop',!1,a].concat(c)))}),this.$domNodes.window.scrollTop()?(this.viewportIsOnTop=!1,this.fireEvent.apply(this,['viewportMovesAwayFromTop',!1,this].concat(c))):(this.viewportIsOnTop=!0,this.fireEvent.apply(this,['viewportMovesToTop',!1,this].concat(c))),this}},{key:'_removeLoadingCover',value:function(){var a=e(regeneratorRuntime.mark(function a(){var b;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.constructor.timeout(this._options.additionalPageLoadingTimeInMilliseconds);case 2:return n(this.constructor.stringFormat('[class^="{1}"], [class*=" {1}"]',this.sliceDomNodeSelectorPrefix(this._options.domNode.startUpAnimationClassPrefix).substr(1))).css(this._options.startUpHide),this.$domNodes.windowLoadingCover.length?(b=this.enableScrolling().$domNodes.windowLoadingCover).animate.apply(b,d(this._options.windowLoadingCoverHideAnimation)):this._options.windowLoadingCoverHideAnimation[1].always(),a.abrupt('return',this);case 5:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}()},{key:'_handleStartUpEffects',value:function(){var a=e(regeneratorRuntime.mark(function a(){var b,c,e=this,f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.$domNodes.windowLoadingCover.hide(),this.$domNodes.windowLoadingSpinner.length&&this.$domNodes.windowLoadingSpinner.spin(!1),!n(this.constructor.stringFormat('[class^="{1}"], [class*=" {1}"]',this.sliceDomNodeSelectorPrefix(this._options.domNode.startUpAnimationClassPrefix).substr(1))).length){a.next=17;break}return a.next=5,this.constructor.timeout(this._options.startUpAnimationElementDelayInMiliseconds);case 5:if(b=!1,this._options.startUpShowAnimation[1].always=function(){b&&e.fireEvent('startUpAnimationComplete')},c=n(this._options.domNode.startUpAnimationClassPrefix+f),c.animate.apply(c,d(this._options.startUpShowAnimation)),!n(this._options.domNode.startUpAnimationClassPrefix+(f+1)).length){a.next=14;break}return a.next=12,this._handleStartUpEffects(f+1);case 12:a.next=15;break;case 14:b=!0;case 15:a.next=18;break;case 17:this.fireEvent('startUpAnimationComplete');case 18:return a.abrupt('return',this);case 19:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}()},{key:'_addNavigationEvents',value:function(){var a=this;return'addEventListener'in n.global&&n.global.addEventListener('hashchange',function(){a.startUpAnimationIsComplete&&a.fireEvent('switchSection',!1,a,location.hash.substring(1))},!1),this._handleScrollToTopButton()}},{key:'_handleScrollToTopButton',value:function(){var a=this;return this.on(this.$domNodes.scrollToTopButton,'click',function(b){b.preventDefault(),a.scrollToTop()}),this}},{key:'_handleAnalyticsInitialisation',value:function(){var a=this;if(this._options.trackingCode&&'__none__'!==this._options.trackingCode&&'location'in n.global&&'localhost'!==n.global.location.hostname){this.debug('Run analytics code: "'+this._analyticsCode.initial+'"',this._options.trackingCode,this._options.domain,this.currentSectionName);try{new Function(this.constructor.stringFormat(this._analyticsCode.initial,this._options.trackingCode,this._options.domain,this.currentSectionName))()}catch(a){this.warn('Problem in analytics initial code snippet: {1}',a)}this.on(this.$domNodes.parent.find('a, button'),'click',function(b){var c=n(b.target);a.triggerAnalyticsEvent(a.currentSectionName,'click',c.text(),b.data||{},c.attr('website-analytics-value')||1)})}return this}}]),b}(n.Tools.class);o._name='Website',b.default=o,n.Website=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return n.Tools().controller(o,b)},n.Website.class=o},function(b){b.exports=a},function(a){a.exports=b},function(a){a.exports=c},function(a){a.exports=d}])});